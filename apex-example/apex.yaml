all_series_config:
  curve: smooth
  extend_to: now
  fill_raw: last
  stroke_width: 2
graph_span: 100h
header:
  show: false
now:
  label: Now
  show: true
series:
  - color: "#AA336A"
    entity: sensor.load_power_new
  - color: "#006400"
    entity: sensor.grid_ct
  - color: "#FFA500"
    entity: sensor.pv_power_now
  - color: "#00008B"
    entity: sensor.battery_soc
    transform: return ((x / 100) * 10.4) - (0.11 * 10.4)
  - color: "#00008B"
    data_generator: |
      const data = JSON.parse(entity.attributes.raw_data)
      return data.map((entry) => {
         return [new Date(entry.period_start), entry.battery];
       });
    entity: sensor.foxess_em_raw_data
    name: Battery
  - color: "#AA336A"
    data_generator: |
      const data = JSON.parse(entity.attributes.raw_data)
      return data.map((entry) => {
         return [new Date(entry.period_start), entry.load*60];
       });
    entity: sensor.foxess_em_raw_data
    name: Load
  - color: "#FFA500"
    data_generator: |
      const data = JSON.parse(entity.attributes.raw_data)
      return data.map((entry) => {
         return [new Date(entry.period_start), entry.pv_estimate*60];
       });
    entity: sensor.foxess_em_raw_data
    name: Forecast
  - color: "#006400"
    data_generator: |
      const data = JSON.parse(entity.attributes.raw_data)
      return data.map((entry) => {
         return [new Date(entry.period_start), entry.grid*60];
       });
    entity: sensor.foxess_em_raw_data
    name: Grid
span:
  start: day
type: custom:apexcharts-card
update_interval: 1min
